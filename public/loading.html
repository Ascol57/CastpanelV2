<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/color.css">
    <link rel="stylesheet" href="css/loader.css">
</head>

<body>
    <div class="flex fullscreen center column" style="color: var(--blue);">
        <div class="loader">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
            <svg width="200px" height="200px" viewBox="0 0 500 200" version="1.1" id="svg1"
                xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"
                xmlns:svg="http://www.w3.org/2000/svg">
                <defs id="defs1">
                    <linearGradient id="linearGradient14">
                        <stop style="stop-color:#00aaff;stop-opacity:1;" offset="0" id="stop14" />
                        <stop style="stop-color:#00aaff;stop-opacity:0;" offset="1" id="stop15" />
                    </linearGradient>
                    <linearGradient id="linearGradient11">
                        <stop style="stop-color:#00aaff;stop-opacity:1" offset="0" id="stop11" />
                        <stop style="stop-color:#00aaff;stop-opacity:0;" offset="1" id="stop12" />
                    </linearGradient>
                    <linearGradient id="linearGradient5">
                        <stop style="stop-color:#00aaff;stop-opacity:1;" offset="0" id="stop5" />
                        <stop style="stop-color:#00aaff;stop-opacity:0;" offset="1" id="stop6" />
                    </linearGradient>
                    <linearGradient xlink:href="#linearGradient5" id="linearGradient6" x1="123.46332" y1="75.301163"
                        x2="64.216217" y2="135.69498" gradientUnits="userSpaceOnUse" />
                    <linearGradient xlink:href="#linearGradient11" id="linearGradient10" x1="68.420853" y1="141.04634"
                        x2="133.0193" y2="61.540554" gradientUnits="userSpaceOnUse" />
                    <linearGradient xlink:href="#linearGradient14" id="linearGradient15" x1="152.13127" y1="49.430607"
                        x2="65.492287" y2="142.69702" gradientUnits="userSpaceOnUse" />
                </defs>
                <g id="layer1">
                    <path
                        d="m 125.00012,137.50013 c 0,-34.62496 -27.875094,-62.500057 -62.500059,-62.500057 v 26.563237 c 17.619438,4.50298 31.433849,18.31739 35.936825,35.93682 z"
                        style="fill:url(#linearGradient6);fill-opacity:1;stroke-width:7.03354;stroke-opacity:0"
                        id="path4" />
                    <path
                        d="m 0,25.000024 v 25.000025 h 25.000024 1.172022 48.828027 c 41.549707,0 75.000077,33.450364 75.000077,75.000071 v 48.82803 1.17202 25.00003 h 25.19484 v -87.50009 h -0.19482 c 0,-48.474661 -39.02542,-87.500086 -87.500085,-87.500086 z"
                        style="fill:url(#linearGradient15);stroke-width:3.06415;stroke-opacity:0" id="path3" />
                    <path
                        d="m 26.172046,50.000049 c -0.394454,0.387056 -0.784966,0.777567 -1.172022,1.172021 v 17.851624 5.976379 h 37.500037 c 34.624758,0 62.500059,27.875307 62.500059,62.500057 v 37.50004 h 5.97638 17.85162 c 0.3945,-0.38709 0.78494,-0.77753 1.17203,-1.17202 v -48.82803 c 0,-41.549707 -33.45037,-75.000071 -75.000077,-75.000071 z"
                        style="fill:url(#linearGradient10);fill-opacity:1;stroke-width:2.31628;stroke-opacity:0"
                        id="path2" />
                    <rect style="fill:#00aaff;fill-opacity:1;stroke-width:4.06501;stroke-opacity:0" id="rect18"
                        width="100" height="100" x="0" y="100" ry="50" />
                    <text x="25" y="170" font-size="65" ,
                        style="font-family:'Cascadia Mono';fill:#ffffff;stroke-width:4.065;opacity: 0;"
                        id="text1"></text>
                    <text x="220" y="170" font-size="65" ,
                        style="font-family:'Cascadia Mono';fill:#ffffff;stroke-width:4.065;opacity: 0;"
                        id="text2"></text>
                </g>
            </svg>

            <script>
                svg = document.querySelector('svg');
                svg.style.width = '500px';

                let prev = performance.now();

                function animate({ timing, draw, duration }) {

                    let start = performance.now();

                    requestAnimationFrame(function animate(time) {
                        // timeFraction goes from 0 to 1
                        let timeFraction = (time - start) / duration;
                        if (timeFraction > 1) timeFraction = 1;

                        // calculate the current animation state
                        let progress = timing(timeFraction)

                        draw(progress); // draw it

                        if (timeFraction < 1) {
                            requestAnimationFrame(animate);
                        }

                    });
                }

                function quad(timeFraction) {
                    return Math.pow(timeFraction, 2)
                }

                text1 = "Cast";
                text2 = "Panel";

                function draw(progress) {
                    svg.style.width = 500 - 300 * progress + 'px';
                    svg.querySelector('#rect18').style.width = 100 + 100 * progress + 'px';
                    svg.querySelector('#path2').style.transform = 'translateX(' + (325 * progress) + 'px)';
                    svg.querySelector('#path3').style.transform = 'translateX(' + (325 * progress) + 'px)';
                    svg.querySelector('#path4').style.transform = 'translateX(' + (325 * progress) + 'px)';
                    svg.querySelector('#text1').innerHTML = text1.slice(0, Math.ceil(text1.length * 2 * progress))
                    svg.querySelector('#text2').innerHTML = text2.slice(0, Math.ceil((text2.length * 2) * neagativetozero(progress - 0.5)))
                    svg.querySelector('#text1').style.opacity = progress;
                    svg.querySelector('#text2').style.opacity = progress;
                }

                function neagativetozero(number) {
                    return number < 0 ? 0 : number;
                }

                window.electronAPI.onLoadingFinished(
                    () => {
                        t = 1000;
                        animate({
                            duration: t,
                            timing: quad,
                            draw: draw
                        });
                        setTimeout(() => {
                            window.electronAPI.finishLoading();
                        }, t + 500);
                    }
                );
            </script>
        </div>
    </div>
</body>

</html>